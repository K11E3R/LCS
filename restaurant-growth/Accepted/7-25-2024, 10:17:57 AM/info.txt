{"id":1332757984,"question_id":1452,"lang":"mysql","lang_name":"MySQL","time":"1 day, 13 hours","timestamp":1721895477,"status":10,"status_display":"Accepted","runtime":"344 ms","url":"/submissions/detail/1332757984/","is_pending":"Not Pending","title":"Restaurant Growth","memory":"0B","code":"# Write your MySQL query statement below\nwith day_amt as (\n    select visited_on, sum(amount) as amount\n    from Customer\n    group by visited_on\n),\nsmmry as (\n    select visited_on, \n        sum(amount) over w as amount,\n        avg(amount) over w as average_amount,\n        row_number() over w as row_no\n    from day_amt\n    window w as (order by visited_on rows between 6 preceding and current row)\n)\nselect visited_on, amount, round(average_amount, 2) as average_amount\nfrom smmry\nwhere row_no >= 7\norder by visited_on","compare_result":"11111111111111","title_slug":"restaurant-growth","has_notes":false,"flag_type":1}