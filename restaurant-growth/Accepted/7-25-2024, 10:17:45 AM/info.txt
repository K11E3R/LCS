{"id":1332757824,"question_id":1452,"lang":"mysql","lang_name":"MySQL","time":"1 day, 13 hours","timestamp":1721895465,"status":10,"status_display":"Accepted","runtime":"449 ms","url":"/submissions/detail/1332757824/","is_pending":"Not Pending","title":"Restaurant Growth","memory":"0B","code":"# Write your MySQL query statement below\nSELECT\n    visited_on,\n    (\n        SELECT SUM(amount)\n        FROM customer\n        WHERE visited_on BETWEEN DATE_SUB(c.visited_on, INTERVAL 6 DAY) AND c.visited_on\n    ) AS amount,\n    ROUND(\n        (\n            SELECT SUM(amount) / 7\n            FROM customer\n            WHERE visited_on BETWEEN DATE_SUB(c.visited_on, INTERVAL 6 DAY) AND c.visited_on\n        ),\n        2\n    ) AS average_amount\nFROM customer c\nWHERE visited_on >= (\n        SELECT DATE_ADD(MIN(visited_on), INTERVAL 6 DAY)\n        FROM customer\n    )\nGROUP BY visited_on;","compare_result":"11111111111111","title_slug":"restaurant-growth","has_notes":false,"flag_type":1}