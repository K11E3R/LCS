{"id":1332754344,"question_id":1390,"lang":"pythondata","lang_name":"Pandas","time":"1Â day, 13Â hours","timestamp":1721895206,"status":10,"status_display":"Accepted","runtime":"472 ms","url":"/submissions/detail/1332754344/","is_pending":"Not Pending","title":"Average Selling Price","memory":"71.3 MB","code":"import pandas as pd\n\ndef average_selling_price(prices: pd.DataFrame, units_sold: pd.DataFrame) -> pd.DataFrame:\n    df = pd.merge(prices, units_sold, on='product_id', how='inner')\n    df = (df\n            .query('purchase_date>=start_date and purchase_date<=end_date')\n            .assign(revenue=df.price*df.units)\n            .groupby('product_id', as_index=False)\n            .apply(lambda x: (x.revenue.sum()/x.units.sum()).round(2))\n            .rename({None:'average_price'},axis=1))\n\n    for pid in set(prices.product_id.unique()) - set(df.product_id.unique()):\n        df.loc[len(df.index)] = [pid, 0]\n        \n    return(df)","compare_result":"11111111111111111","title_slug":"average-selling-price","has_notes":false,"flag_type":1}