{"id":1332758984,"question_id":602,"lang":"mysql","lang_name":"MySQL","time":"1 day, 13 hours","timestamp":1721895550,"status":10,"status_display":"Accepted","runtime":"253 ms","url":"/submissions/detail/1332758984/","is_pending":"Not Pending","title":"Friend Requests II: Who Has the Most Friends","memory":"0B","code":"# Write your MySQL query statement below\n\n(SELECT r.requester_id as id,IFNULL(count(requester_id),0) + IFNULL(acc.cnt,0) as num\nfrom (Select count(accepter_id)  as cnt, accepter_id as id\nfrom RequestAccepted r\nGROUP BY r.accepter_id\n) as acc RIGHT OUTER JOIN RequestAccepted r \nON acc.id=r.requester_id \nGROUP BY r.requester_id\n)\nUNION (\nSelect accepter_id as id,count(accepter_id) as num\nfrom RequestAccepted r\nwhere accepter_id NOT IN (\n    SELECT distinct requester_id from RequestAccepted\n)\nGROUP BY r.accepter_id\n)\nORDER BY num desc\nlimit 1","compare_result":"111111111111","title_slug":"friend-requests-ii-who-has-the-most-friends","has_notes":false,"flag_type":1}