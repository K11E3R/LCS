{"id":1328467506,"question_id":1182,"lang":"pythondata","lang_name":"Pandas","time":"5 days, 8 hours","timestamp":1721567948,"status":10,"status_display":"Accepted","runtime":"512 ms","url":"/submissions/detail/1328467506/","is_pending":"Not Pending","title":"Game Play Analysis IV","memory":"70.4 MB","code":"import pandas as pd\n\ndef gameplay_analysis(activity: pd.DataFrame) -> pd.DataFrame:\n    agg_activity = (\n        activity\n        .assign(\n            first_day=lambda frame: (\n                frame\n                .groupby(\"player_id\")\n                [[\"event_date\"]]\n                .transform(\"min\")\n            ),\n            is_day=lambda frame: (\n                (frame.event_date - frame.first_day)\n                .dt\n                .days\n            )\n        )\n        .query(\"is_day == 1\")\n    )\n\n    return (\n        pd.DataFrame(\n            {\n                \"fraction\": [\n                    round(agg_activity.player_id.nunique() / activity.player_id.nunique(), 2)\n                ],\n            },\n        )\n    )","compare_result":"111111111111111","title_slug":"game-play-analysis-iv","has_notes":false,"flag_type":1}